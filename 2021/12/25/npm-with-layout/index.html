<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="Here I am going to perform the layout first for news-publish-management 1. Setup setupProxy.js12yarn add http-proxy-middlewaretouch src&#x2F;setupProxy.js copy below code-snippets into setupProxy. 12345678">
<meta property="og:type" content="article">
<meta property="og:title" content="news-pubish-management(1)--layout">
<meta property="og:url" content="http://example.com/2021/12/25/npm-with-layout/index.html">
<meta property="og:site_name" content="Nate Liu&#39;s Blog">
<meta property="og:description" content="Here I am going to perform the layout first for news-publish-management 1. Setup setupProxy.js12yarn add http-proxy-middlewaretouch src&#x2F;setupProxy.js copy below code-snippets into setupProxy. 12345678">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-12-25T14:44:01.000Z">
<meta property="article:modified_time" content="2022-01-23T09:06:01.857Z">
<meta property="article:author" content="Nate Liu">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2021/12/25/npm-with-layout/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2021/12/25/npm-with-layout/","path":"2021/12/25/npm-with-layout/","title":"news-pubish-management(1)--layout"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>news-pubish-management(1)--layout | Nate Liu's Blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Nate Liu's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Setup-setupProxy-js"><span class="nav-number">1.</span> <span class="nav-text">1. Setup setupProxy.js</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Assume-NewsSandBox-js-as-a-second-level-router-and-change-its-content-to"><span class="nav-number">2.</span> <span class="nav-text">3. Assume NewsSandBox.js  as a second level router, and change its content to</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Import-Ant-Design-and-setup-layout-our-layout-was-designed-in-src-views-sandbox-NewsSandBox-js-NewsSandBox-contains-src-components-sandbox-TopHeader-js-and-src-componets-sandbox-SideMenu-js"><span class="nav-number">3.</span> <span class="nav-text">4. Import Ant Design and setup layout, our layout was designed in src&#x2F;views&#x2F;sandbox&#x2F;NewsSandBox.js. NewsSandBox contains src&#x2F;components&#x2F;sandbox&#x2F;TopHeader.js and src&#x2F;componets&#x2F;sandbox&#x2F;SideMenu.js&#96;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-Add-click-event-on-the-collapsed-expanded-icon-in-src-components-sandbox-TopHeader-js"><span class="nav-number">4.</span> <span class="nav-text">5. Add click event on the collapsed&#x2F;expanded icon in src&#x2F;components&#x2F;sandbox&#x2F;TopHeader.js.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-Add-Wellcome-user-in-the-TopHeader"><span class="nav-number">5.</span> <span class="nav-text">6. Add Wellcome user in the TopHeader.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-Modify-the-SideMenu"><span class="nav-number">6.</span> <span class="nav-text">7. Modify the SideMenu</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-Fix-some-issue-for-SideMenu"><span class="nav-number">7.</span> <span class="nav-text">8. Fix some issue for SideMenu</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Nate Liu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/nateliu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;nateliu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jinliangliu@163.com" title="E-Mail → mailto:jinliangliu@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/12/25/npm-with-layout/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Nate Liu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nate Liu's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          news-pubish-management(1)--layout
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-12-25 14:44:01" itemprop="dateCreated datePublished" datetime="2021-12-25T14:44:01+00:00">2021-12-25</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-01-23 09:06:01" itemprop="dateModified" datetime="2022-01-23T09:06:01+00:00">2022-01-23</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Here I am going to perform the layout first for news-publish-management</p>
<h3 id="1-Setup-setupProxy-js"><a href="#1-Setup-setupProxy-js" class="headerlink" title="1. Setup setupProxy.js"></a>1. Setup setupProxy.js</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add http-proxy-middleware</span><br><span class="line">touch src/setupProxy.js</span><br></pre></td></tr></table></figure>
<p>copy below <a target="_blank" rel="noopener" href="https://create-react-app.dev/docs/proxying-api-requests-in-development/#configuring-the-proxy-manually">code-snippets</a> into <span style="color:lightblue">setupProxy</span>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; createProxyMiddleware &#125; = <span class="built_in">require</span>(<span class="string">&#x27;http-proxy-middleware&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">app</span>) </span>&#123;</span><br><span class="line">  app.use(</span><br><span class="line">    <span class="string">&#x27;/api&#x27;</span>,</span><br><span class="line">    createProxyMiddleware(&#123;</span><br><span class="line">      <span class="attr">target</span>: <span class="string">&#x27;https://news-publish-management.herokuapp.com&#x27;</span>,</span><br><span class="line">      <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="string">``</span><span class="string">``</span></span><br><span class="line">&gt; Why we setup like <span class="built_in">this</span> <span class="keyword">in</span> our project? The main reason <span class="keyword">for</span> doing <span class="built_in">this</span> is avoids [CORS](https:<span class="comment">//stackoverflow.com/questions/21854516/understanding-ajax-cors-and-security-considerations) issues </span></span><br><span class="line">### <span class="number">2.</span> Setup router</span><br><span class="line"><span class="string">``</span><span class="string">`bash</span></span><br><span class="line"><span class="string">yarn add react-router-dom</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mkdir src/router                  </span></span><br><span class="line"><span class="string">touch src/router/IndexRouter.js</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mkdir src/views</span></span><br><span class="line"><span class="string">mkdir src/views/login</span></span><br><span class="line"><span class="string">touch src/views/login/Login.js</span></span><br><span class="line"><span class="string">mkdir src/views/sandbox</span></span><br><span class="line"><span class="string">touch src/views/sandbox/NewsSandBox.js</span></span><br><span class="line"><span class="string">mkdir src/views/sandbox/home</span></span><br><span class="line"><span class="string">touch src/views/sandbox/home/Home.js</span></span><br><span class="line"><span class="string">mkdir src/views/sandbox/user-manage</span></span><br><span class="line"><span class="string">touch src/views/sandbox/user-manage/UserList.js</span></span><br><span class="line"><span class="string">mkdir src/views/sandbox/right-manage</span></span><br><span class="line"><span class="string">touch src/views/sandbox/right-manage/RightList.js</span></span><br><span class="line"><span class="string">touch src/views/sandbox/right-manage/RoleList.js</span></span><br><span class="line"><span class="string">mkdir src/views/sandbox/nopermission</span></span><br><span class="line"><span class="string">touch src/views/sandbox/nopermission/NoPermission.js</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mkdir src/components </span></span><br><span class="line"><span class="string">mkdir src/components/sandbox</span></span><br><span class="line"><span class="string">touch src/components/sandbox/SideMenu.js</span></span><br><span class="line"><span class="string">touch src/components/sandbox/TopHeader.js</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>Every each JS file we can add below code-snippets for creating react function component quickly.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">ComponentName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            ComponentName</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>We can install a plugin <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=dsznajder.es7-react-js-snippets">ES7 React/Redux/GraphQL/React-Native snippets</a> for <a target="_blank" rel="noopener" href="https://code.visualstudio.com/">VS Code</a>. Once install successfully, use key <code>rfc</code> for lightning generating above code-snippets.</p>
</blockquote>
<p>We assume <span style="color:lightblue">src/router/IndexRouter.js</span> is the first level router, when user already logined the system,  they will be redirected to <span style="color:lightblue">src/views/sandbox/NewsSandBox.js</span>, otherwise they will be redireted to <span style="color:lightblue">src/views/login/Login.js</span>. So the <span style="color:lightblue">IndexRouter.js</span> looks like below</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; HashRouter, Routes, Route, Navigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Login <span class="keyword">from</span> <span class="string">&#x27;../views/login/Login&#x27;</span></span><br><span class="line"><span class="keyword">import</span> NewsSandBox <span class="keyword">from</span> <span class="string">&#x27;../views/sandbox/NewsSandBox&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">IndexRouter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Login</span>/&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;*&quot;</span> <span class="attr">element</span>=<span class="string">&#123;localStorage.getItem(</span>&quot;<span class="attr">token</span>&quot;) ? &lt;<span class="attr">NewsSandBox</span>/&gt;</span> : <span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Go to <span style="color:lightblue">src/App.js</span>, and import our <span style="color:lightblue">src/router/IndexRouter.js</span> component.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> IndexRouter <span class="keyword">from</span> <span class="string">&#x27;./router/IndexRouter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">IndexRouter</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Go to browser, url <code>https//localhost:3000</code> will show our <code>Login</code> component. If you manually setup the token with command of </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">localStorage</span>.setItem(<span class="string">&quot;token&quot;</span>,<span class="string">&quot;token&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>then the browser will show <code>NewsSandBox</code> component.</p>
<h3 id="3-Assume-NewsSandBox-js-as-a-second-level-router-and-change-its-content-to"><a href="#3-Assume-NewsSandBox-js-as-a-second-level-router-and-change-its-content-to" class="headerlink" title="3. Assume NewsSandBox.js  as a second level router, and change its content to"></a>3. Assume <span style="color:lightblue">NewsSandBox.js </spn> as a second level router, and change its content to</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; Routes, Route, Navigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> SideMenu <span class="keyword">from</span> <span class="string">&#x27;../../components/sandbox/SideMenu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> TopHeader <span class="keyword">from</span> <span class="string">&#x27;../../components/sandbox/TopHeader&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">&#x27;./home/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> NoPermission <span class="keyword">from</span> <span class="string">&#x27;./nopermission/NoPermission&#x27;</span></span><br><span class="line"><span class="keyword">import</span> RightList <span class="keyword">from</span> <span class="string">&#x27;./right-manage/RightList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> RoleList <span class="keyword">from</span> <span class="string">&#x27;./right-manage/RoleList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> UserList <span class="keyword">from</span> <span class="string">&#x27;./user-manage/UserList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">NewsSandBox</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">SideMenu</span> /&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">TopHeader</span> /&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;home&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;user-manage/list&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">UserList</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;right-manage/role/list&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">RoleList</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;right-manage/right/list&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">RightList</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Navigate</span> <span class="attr">replace</span> <span class="attr">from</span>=<span class="string">&quot;/&quot;</span> <span class="attr">to</span>=<span class="string">&quot;home&quot;</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/*&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">NoPermission</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-Import-Ant-Design-and-setup-layout-our-layout-was-designed-in-src-views-sandbox-NewsSandBox-js-NewsSandBox-contains-src-components-sandbox-TopHeader-js-and-src-componets-sandbox-SideMenu-js"><a href="#4-Import-Ant-Design-and-setup-layout-our-layout-was-designed-in-src-views-sandbox-NewsSandBox-js-NewsSandBox-contains-src-components-sandbox-TopHeader-js-and-src-componets-sandbox-SideMenu-js" class="headerlink" title="4. Import Ant Design and setup layout, our layout was designed in src/views/sandbox/NewsSandBox.js. NewsSandBox contains src/components/sandbox/TopHeader.js and src/componets/sandbox/SideMenu.js`"></a>4. Import <a target="_blank" rel="noopener" href="https://ant-design.gitee.io/">Ant Design</a> and setup layout, our layout was designed in <span style="color:lightblue">src/views/sandbox/NewsSandBox.js</span>. <code>NewsSandBox</code> contains <span style="color:lightblue">src/components/sandbox/TopHeader.js</span> and <span style="color:lightblue">src/componets/sandbox/SideMenu.js`</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add antd</span><br></pre></td></tr></table></figure>
<p>choose the <a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/layout/#components-layout-demo-custom-trigger">custom trigger</a> as our layout. First thing is <code>show code</code> and copy code into <code>NewsSandBox</code> and then sperate them as below <br/></p>
<ul>
<li><code>Layout.Sider</code> was pasted to <code>SideMenu</code></li>
<li><code>Layout.Header</code> was pasted to <code>TopHeader</code></li>
</ul>
<blockquote>
<p>The import thing is don’t forget to copy the CSS into our <span style="color:lightblue">src/views/sandbox/NewsSandBox.css</span> file.</p>
</blockquote>
<h3 id="5-Add-click-event-on-the-collapsed-expanded-icon-in-src-components-sandbox-TopHeader-js"><a href="#5-Add-click-event-on-the-collapsed-expanded-icon-in-src-components-sandbox-TopHeader-js" class="headerlink" title="5. Add click event on the collapsed/expanded icon in src/components/sandbox/TopHeader.js."></a>5. Add click event on the collapsed/expanded icon in <span style="color:lightblue">src/components/sandbox/TopHeader.js</span>.</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [collapsed, setCollapsed] = useState(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> changeCollapsed = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    setCollapsed(!collapsed)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-state.html">React hooks</a>  is important. Here we use the <code>useState</code>.</p>
</blockquote>
<p>Then give the icon an onClick event property. for example</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;MenuFoldOutlined onClick=&#123;changeCollapsed&#125; /&gt;</span><br></pre></td></tr></table></figure>

<h3 id="6-Add-Wellcome-user-in-the-TopHeader"><a href="#6-Add-Wellcome-user-in-the-TopHeader" class="headerlink" title="6. Add Wellcome user in the TopHeader."></a>6. Add <code>Wellcome user</code> in the TopHeader.</h3><p>We copy the <a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/dropdown/#components-dropdown-demo-basic">Dropdown Basic</a> and <a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/avatar/#components-avatar-demo-basic">Avator Basic</a> components and modify them as we expected.</p>
<h3 id="7-Modify-the-SideMenu"><a href="#7-Modify-the-SideMenu" class="headerlink" title="7. Modify the SideMenu"></a>7. Modify the SideMenu</h3><p>use <a target="_blank" rel="noopener" href="https://axios-http.com/docs/intro">axios</a> for getting data.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn add axios</span><br><span class="line">mkdir src/util</span><br><span class="line">touch src/util/http.js</span><br></pre></td></tr></table></figure>
<p>http.js with content</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line">axios.defaults.baseURL=<span class="string">&quot;https://news-publish-management.herokuapp.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// axios.defaults.headers</span></span><br><span class="line"><span class="comment">// axios.interceptors.request.use</span></span><br><span class="line"><span class="comment">// axios.interceptors.response.use</span></span><br></pre></td></tr></table></figure>
<p>In this page, will use hook <code>useEffect</code> for getting data back and use  hook <code>useState</code> to control returned data</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; Layout, Menu &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    UserOutlined,</span><br><span class="line">    HomeOutlined,</span><br><span class="line">    CrownOutlined,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; Sider &#125; = Layout;</span><br><span class="line"><span class="keyword">const</span> &#123; SubMenu &#125; = Menu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">SideMenu</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> navigate = useNavigate();</span><br><span class="line">    <span class="keyword">const</span> [menuList, setMenuList] = useState([]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> renderMenu = <span class="function">(<span class="params">menuList</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> menuList.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (item.children) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">SubMenu</span> <span class="attr">key</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">icon</span>=<span class="string">&#123;item.icon&#125;</span> <span class="attr">title</span>=<span class="string">&#123;item.title&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    &#123;renderMenu(item.children)&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">SubMenu</span>&gt;</span></span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Menu.Item</span> <span class="attr">key</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">icon</span>=<span class="string">&#123;item.icon&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> navigate(item.key)&#125;&gt;</span></span><br><span class="line"><span class="xml">                &#123;item.title&#125;<span class="tag">&lt;/<span class="name">Menu.Item</span>&gt;</span></span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        axios.get(<span class="string">&quot;/api/rights?_embed=children&quot;</span>).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">// console.log(res.data)</span></span><br><span class="line">            setMenuList(res.data);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;, [])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;false&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span>&gt;</span>News Publish Management<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Menu</span> <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span> <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;&gt;</span></span></span><br><span class="line"><span class="xml">                &#123;renderMenu(menuList)&#125;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-Fix-some-issue-for-SideMenu"><a href="#8-Fix-some-issue-for-SideMenu" class="headerlink" title="8. Fix some issue for SideMenu"></a>8. Fix some issue for SideMenu</h3><p>Finished above 7 steps, the page should be correctly rendering, but it is weird, some menu should be in second level route, but it is in SideMenu, another thing is each of the menu without icon. Let’s fix those issues we identified so far:</p>
<ul>
<li>For issue 1, we can identifiy the field pagepermission, check its 1 or not.<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> checkPagePermission = <span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item.pagepermission === <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>pagepermission is very important!!</p>
</blockquote>
</li>
<li>For issue 2, we can define an iconList to store icon, and use array[index] to get the icon.<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">const</span> iconList = &#123;</span><br><span class="line">    <span class="string">&#x27;/home&#x27;</span>:<span class="xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="string">&#x27;/user-manage&#x27;</span>:<span class="xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="string">&#x27;/user-manage/list&#x27;</span>:<span class="xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="string">&#x27;/right-manage&#x27;</span>:<span class="xml"><span class="tag">&lt;<span class="name">CrownOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="string">&#x27;/right-manage/role/list&#x27;</span>:<span class="xml"><span class="tag">&lt;<span class="name">CrownOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="string">&#x27;/right-manage/right/list&#x27;</span>:<span class="xml"><span class="tag">&lt;<span class="name">CrownOutlined</span> /&gt;</span></span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Issue 3, The Home is no children, we do not need the expansed icon in the right, so we have to add children.length to check<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">item.children?.length &gt; <span class="number">0</span> &amp;&amp; checkPagePermission(item)</span><br></pre></td></tr></table></figure></li>
<li>Issue 4, the style is egly, we import <code>antd.css</code> into <code>App.css</code><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;~antd/dist/antd.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line">::-webkit-scrollbar &#123;width: <span class="number">5px</span>;<span class="attribute">height</span>: <span class="number">5px</span>;<span class="attribute">position</span>:absolute&#125;</span><br><span class="line">::-webkit-scrollbar-thumb &#123;background-color: <span class="number">#1890ff</span>;&#125;</span><br><span class="line">::-webkit-scrollbar-track &#123;background-color: <span class="number">#ddd</span>;&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>-Issue 5, focus the previous select menu if user refresh page.<br>Menu component have SelectedKeys and defaultOpenKeys, we can set those two field to fix our issue.<br>In Ant library, most of time, if field called defaultXXXX, that meant it is uncontrolled field, otherwise it use useState for controlling.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> location = useLocation();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> selectKeys = [location.pathname]; </span><br><span class="line"><span class="keyword">const</span> openKeys = [<span class="string">&quot;/&quot;</span> + location.pathname.split(<span class="string">&quot;/&quot;</span>)[<span class="number">1</span>]];</span><br><span class="line"></span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">&lt;Menu theme=<span class="string">&quot;dark&quot;</span> mode=<span class="string">&quot;inline&quot;</span> selectedKeys=&#123;selectKeys&#125; defaultOpenKeys=&#123;openKeys&#125;&gt;</span><br><span class="line">                    &#123;renderMenu(menuList)&#125;</span><br><span class="line">                &lt;/Menu&gt;</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/12/22/publish-app-to-netlify-and-heroku/" rel="prev" title="publish news-publish-management to netlify and heroku">
                  <i class="fa fa-chevron-left"></i> publish news-publish-management to netlify and heroku
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/12/26/npm-with-right-role-user/" rel="next" title="news-pubish-management(2)--right, role and user">
                  news-pubish-management(2)--right, role and user <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nate Liu</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
